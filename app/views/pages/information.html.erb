<style>
/* ã‚·ãƒ³ãƒ—ãƒ«ãªã‚¿ãƒ–ï¼ˆJSä¸è¦ï¼‰ */
.tabs{max-width:900px;margin:0 auto;padding:1rem}
.tab-labels{display:flex;gap:0.25rem;flex-wrap:wrap}
.tab-labels label{background:#f3f4f6;padding:0.6rem 1rem;border-radius:6px;cursor:pointer;border:1px solid #e5e7eb}
.tab-labels label:hover{background:#eef2ff}
.tabs input{display:none}
.tab-panels{margin-top:1rem;border:1px solid #e5e7eb;padding:1rem;border-radius:6px;background:#fff}
.panel{display:none}
.tab-input:checked ~ .tab-panels .panel{display:none}
#tab1:checked ~ .tab-panels #panel1,
#tab2:checked ~ .tab-panels #panel2,
#tab3:checked ~ .tab-panels #panel3,
#tab4:checked ~ .tab-panels #panel4,
#tab5:checked ~ .tab-panels #panel5,
#tab6:checked ~ .tab-panels #panel6,
#tab7:checked ~ .tab-panels #panel7,
#tab8:checked ~ .tab-panels #panel8{display:block}
.tab-labels label.active{background:#fff;border-bottom:2px solid #3b82f6}
/* ãƒ©ãƒ™ãƒ«ã®ã‚¢ã‚¯ãƒ†ã‚£ãƒ–è¦‹ãŸç›®ï¼ˆãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ï¼‰ */
#tab1:checked ~ .tab-labels label[for="tab1"],
#tab2:checked ~ .tab-labels label[for="tab2"],
#tab3:checked ~ .tab-labels label[for="tab3"],
#tab4:checked ~ .tab-labels label[for="tab4"],
#tab5:checked ~ .tab-labels label[for="tab5"],
#tab6:checked ~ .tab-labels label[for="tab6"],
#tab7:checked ~ .tab-labels label[for="tab7"],
#tab8:checked ~ .tab-labels label[for="tab8"]{background:#fff;border-bottom:2px solid #3b82f6}

.panel h2{margin-top:0; display: flex; align-items: center; justify-content: space-between;}
.panel p{margin-bottom:0.5rem}
.meta{color:#6b7280;font-size:0.9rem}
.panel-img{width:100%;height:auto;border-radius:6px;margin-bottom:0.6rem;object-fit:cover}

/* Like button styles */
.like-btn {
  background: none;
  border: none;
  cursor: pointer;
  font-size: 1.2rem;
  margin-left: 0.5rem;
}
.like-btn.liked {
  color: #ffd700;
}
.like-count {
  margin-left: 0.2rem;
  font-weight: bold;
}

@media (max-width:600px){.tab-labels label{flex:1 1 100%;text-align:center}}
</style>

<h1>æ¾æ±Ÿå¸‚ã®è¦³å…‰åæ‰€</h1>

<div class="tabs">
	<% @attractions.each_with_index do |attraction, index| %>
		<input id="tab<%= index + 1 %>" type="radio" name="tabs" <%= 'checked' if index == 0 %>>
	<% end %>

	<div class="tab-labels">
		<% @attractions.each_with_index do |attraction, index| %>
			<label for="tab<%= index + 1 %>">
				<%= attraction.name %>
			</label>
		<% end %>
	</div>

	<div class="tab-panels">
		<% @attractions.each_with_index do |attraction, index| %>
			<div class="panel" id="panel<%= index + 1 %>">
				<img class="panel-img" src="<%= attraction.image_url %>" alt="<%= attraction.name %>">
				<h2>
					<span><%= attraction.name %></span>
					<div>
						<button class="like-btn <%= 'liked' if Like.exists?(attraction: attraction, session_id: session.id.to_s) %>" data-attraction-id="<%= attraction.id %>">
							ğŸ‘
						</button>
						<span class="like-count"><%= attraction.likes.count %></span>
					</div>
				</h2>
				<p class="meta">æ‰€åœ¨åœ°: <%= attraction.location %></p>
				<p><%= attraction.description %></p>
			</div>
		<% end %>
	</div>
</div>

<p class="meta" style="max-width:900px;margin:0.75rem auto">ä»–ã«ã‚‚ç¾è¡“é¤¨ã‚„æ¸©æ³‰ã€éƒ·åœŸæ–™ç†ã‚’æ¥½ã—ã‚ã‚‹ãŠåº—ãŒãŸãã•ã‚“ã‚ã‚Šã¾ã™ã€‚è©³ã—ãè¼‰ã›ãŸã„å ´æ‰€ãŒã‚ã‚Œã°æ•™ãˆã¦ãã ã•ã„ã€‚</p>

<script>
document.addEventListener('DOMContentLoaded', function() {
  document.querySelectorAll('.like-btn').forEach(btn => {
    btn.addEventListener('click', function(e) {
      e.preventDefault();
      const attractionId = this.dataset.attractionId;
      const likeBtn = this;
      const countSpan = this.nextElementSibling;

      fetch('/likes/toggle', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
          'X-CSRF-Token': document.querySelector('meta[name="csrf-token"]').content
        },
        body: JSON.stringify({ attraction_id: attractionId })
      })
      .then(response => response.json())
      .then(data => {
        if (data.liked) {
          likeBtn.classList.add('liked');
        } else {
          likeBtn.classList.remove('liked');
        }
        countSpan.textContent = data.count;
      });
    });
  });
});
</script>

